<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Leaderboard</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-icons/1.11.1/font/bootstrap-icons.min.css" rel="stylesheet">

  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
      color: #e94560;
      min-height: 100vh;
      padding: 20px 0;
    }

    /* Header */
    .leaderboard-header {
      text-align: center;
      margin-bottom: 30px;
      padding: 20px;
    }

    .leaderboard-title {
      font-size: 2.5rem;
      font-weight: 900;
      background: linear-gradient(135deg, #e94560, #f39c12, #e74c3c);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 10px;
    }

    .leaderboard-subtitle { color: #a8b2d1; }

    /* Tabs */
    .tabs {
      display: flex;
      gap: 10px;
      padding: 20px;
      justify-content: center;
      flex-wrap: wrap;
    }

    .tab-btn {
      padding: 12px 24px;
      background: rgba(233, 69, 96, 0.1);
      border: 2px solid rgba(233, 69, 96, 0.3);
      border-radius: 25px;
      color: #a8b2d1;
      cursor: pointer;
      transition: 0.3s;
      font-weight: 600;
      text-decoration: none;
    }

    .tab-btn:hover {
      background: rgba(233, 69, 96, 0.2);
      border-color: #e94560;
      color: #e94560;
      transform: translateY(-2px);
    }

    .tab-btn.active {
      background: linear-gradient(135deg, #e94560, #e74c3c);
      color: white;
      border-color: transparent;
      box-shadow: 0 6px 20px rgba(233, 69, 96, 0.5);
    }

    /* Sort Box */
    .sort-box {
      margin: 20px auto;
      padding: 20px;
      background: rgba(22, 33, 62, 0.8);
      border-radius: 20px;
      backdrop-filter: blur(5px);
      width: fit-content;
      display: flex;
      gap: 15px;
      align-items: center;
    }

    .sort-select {
      padding: 12px 40px 12px 20px;
      border-radius: 25px;
      background: #16213e;
      border: 2px solid rgba(233, 69, 96, 0.3);
      color: #e94560;
      background-image: url("data:image/svg+xml;utf8,<svg fill='%23e94560' width='24' height='24'><path d='M7 10l5 5 5-5z'/></svg>");
      background-position: right 12px center;
      background-repeat: no-repeat;
    }

    /* Podium / Winner Cards */
    .top-winners-section { margin-bottom: 40px; }

    .winners-wrapper {
      display: flex;
      justify-content: center;
      align-items: flex-end;
      gap: 25px;
      flex-wrap: wrap;
    }

    .winner-card {
      background: rgba(22, 33, 62, 0.9);
      padding: 30px;
      text-align: center;
      border-radius: 25px;
      border: 3px solid transparent;
      position: relative;
      transition: 0.4s;
      width: 250px;
    }

    .winner-card:hover {
      transform: translateY(-10px);
      box-shadow: 0 20px 50px rgba(233, 69, 96, 0.4);
    }

    .winner-card.position-1 { transform: scale(1.15) translateY(-30px); }
    .winner-card.position-2 { transform: scale(1.05); }
    .winner-card.position-3 { transform: scale(1.05) translateY(10px); }

    .position-number {
      width: 55px;
      height: 55px;
      border-radius: 50%;
      background: gold;
      position: absolute;
      top: -25px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 1.4rem;
      font-weight: 700;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    .winner-avatar {
      width: 130px;
      height: 130px;
      border-radius: 15px;
      overflow: hidden;
      margin: 10px auto;
      border: 4px solid #e94560;
    }

    .winner-name { font-size: 1.2rem; color: #e94560; margin-top: 10px; }

    /* Ranking List */
    .rank-row {
      display: flex;
      gap: 20px;
      padding: 20px;
      background: rgba(22,33,62,0.75);
      border-radius: 20px;
      margin-bottom: 15px;
      border: 2px solid rgba(233,69,96,0.25);
      transition: 0.3s;
      align-items: center;
    }

    .rank-row:hover {
      transform: translateY(-5px);
      border-color: #e94560;
    }

    .profile-img {
      width: 90px;
      height: 90px;
      border-radius: 15px;
      object-fit: cover;
      border: 3px solid #e94560;
    }

    .stars { color: #FFD700; font-size: 1.2rem; }
    .rating-number { color: #f39c12; font-weight: bold; }
  </style>
</head>

<body>

<div class="container" th:attr="data-tab=${tab}">

  <!-- Header -->
  <div class="leaderboard-header">
    <h1 class="leaderboard-title">üèÜ Leaderboard</h1>
    <p class="leaderboard-subtitle">Top rated movies and talent in the industry</p>
  </div>

  <!-- Tabs -->
  <div class="tabs">
    <a class="tab-btn" th:classappend="${tab=='movies'} ? ' active'" th:href="@{/showpeoplerevi(tab='movies',sort=${sort})}">üé¨ Movies</a>
    <a class="tab-btn" th:classappend="${tab=='actor'} ? ' active'" th:href="@{/showpeoplerevi(tab='actor',sort=${sort})}">üé≠ Actors</a>
    <a class="tab-btn" th:classappend="${tab=='actress'} ? ' active'" th:href="@{/showpeoplerevi(tab='actress',sort=${sort})}">üë©‚Äçü¶∞ Actresses</a>
    <a class="tab-btn" th:classappend="${tab=='director'} ? ' active'" th:href="@{/showpeoplerevi(tab='director',sort=${sort})}">üé• Directors</a>
    <a class="tab-btn" th:classappend="${tab=='music'} ? ' active'" th:href="@{/showpeoplerevi(tab='music',sort=${sort})}">üéß Music Directors</a>
  </div>

  <!-- Sort -->
  <div class="sort-box">
    <label>Sort By:</label>
    <select id="sort" class="sort-select" onchange="chooseSort()">
      <option value="rating_desc" th:selected="${sort=='rating_desc'}">Rating (High ‚Üí Low)</option>
      <option value="rating_asc" th:selected="${sort=='rating_asc'}">Rating (Low ‚Üí High)</option>
      <option value="name_asc" th:selected="${sort=='name_asc'}">Name (A ‚Üí Z)</option>
      <option value="name_desc" th:selected="${sort=='name_desc'}">Name (Z ‚Üí A)</option>
    </select>
  </div>

  <!-- ==================== TOP WINNERS (Podium) ==================== -->
  <div class="top-winners-section">
    <div class="winners-wrapper">

      <!-- Position 1 -->
      <div class="winner-card position-1" th:if="${top3[0] != null}">
        <div class="position-number">1</div>
        <div class="winner-avatar">
          <img th:src="@{${top3[0].img}}" />
        </div>
        <div class="winner-name" th:text="${top3[0].name}"></div>
      </div>

      <!-- Position 2 -->
      <div class="winner-card position-2" th:if="${top3[1] != null}">
        <div class="position-number">2</div>
        <div class="winner-avatar">
          <img th:src="@{${top3[1].img}}" />
        </div>
        <div class="winner-name" th:text="${top3[1].name}"></div>
      </div>

      <!-- Position 3 -->
      <div class="winner-card position-3" th:if="${top3[2] != null}">
        <div class="position-number">3</div>
        <div class="winner-avatar">
          <img th:src="@{${top3[2].img}}" />
        </div>
        <div class="winner-name" th:text="${top3[2].name}"></div>
      </div>

    </div>
  </div>

  <!-- ==================== LIST CONTENT ==================== -->
  <div th:each="item : ${list}">
    <div class="rank-row">
      <img class="profile-img" th:src="@{${item.img}}">
      <div>
        <div class="name" th:text="${item.name}"></div>
        <div class="stars"
             th:utext="${#strings.repeat('‚òÖ', item.rating.intValue())} + ${#strings.repeat('‚òÜ', 5 - item.rating.intValue())}">
        </div>
        <div class="rating-number"><span th:text="${item.rating}"></span> / 5</div>
      </div>
    </div>
  </div>

</div>

<script>
  function chooseSort() {
    const sort = document.getElementById("sort").value;
    const tab = document.querySelector('[data-tab]').dataset.tab;
    window.location.href = `/showpeoplerevi?tab=${tab}&sort=${sort}`;
  }
</script>

</body>
</html>
